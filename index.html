<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Special Question for Chloe</title>
<style>
    body {
        margin: 0; padding: 0; height: 100vh;
        display: flex; justify-content: center; align-items: flex-start; 
        background-color: #a0cfee; overflow: hidden;
        font-family: "Times New Roman", Times, serif;
        font-size: 15px; 
    }

    .anime-bg-layer {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
        background-image: url('assets/anime-bg.jpg'); 
        background-size: cover; background-position: center; opacity: 0.5;
        transition: background-image 0.5s ease-in-out;
    }

    .sketch-container {
        background: rgba(255, 255, 255, 0.95);
        padding: 40px; border-radius: 15px;
        box-shadow: 0 0 0 4px #fff, 0 0 0 7px #000, 10px 10px 0 0 rgba(0,0,0,0.2);
        text-align: center; position: relative; z-index: 10;
        width: 550px; max-width: 90%; margin-top: 10vh;
        min-height: 480px; display: flex; flex-direction: column;
    }

    /* OVERLAYS */
    #videoOverlay, #confirmOverlay, #wrongPopupOverlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.9); display: none; justify-content: center;
        align-items: center; z-index: 6000; flex-direction: column;
    }

    .modal-box {
        background: white; padding: 30px; border: 4px solid #000;
        border-radius: 10px; text-align: center; width: 380px;
    }

    #pastaVideo {
        width: 70vw; max-width: 594px; aspect-ratio: 594 / 420;
        border: 5px solid #fff; border-radius: 5px;
    }

    .btn {
        padding: 12px 25px; font-size: 1.3em; cursor: pointer;
        border: 3px solid #000; background: white; border-radius: 15px;
        font-family: "Times New Roman", Times, serif;
        transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); margin: 5px;
    }

    #yesBtn { background-color: #ffdde1; color: #d63031; }
    #noBtn { background-color: #dfe6e9; color: #636e72; }

    #musicToggle {
        position: fixed; bottom: 20px; right: 20px; z-index: 2000;
        background: white; border: 2px solid #000; padding: 10px 20px;
        border-radius: 50px; font-size: 0.9em; cursor: pointer; display: none;
    }

    .nav-container {
        display: flex; justify-content: space-between; align-items: center;
        margin-top: auto; border-top: 2px dashed #ccc; padding-top: 15px;
    }

    .step { display: none; flex-direction: column; height: 100%; }
    .active-step { display: flex; }

    #proofImage { width: 100%; max-height: 200px; object-fit: contain; margin-bottom: 10px; display: none; border: 2px solid #333; }
    
    /* FINAL FLOATING PICS */
    .final-pics { 
        position: relative; 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        gap: 20px; 
        margin-top: 30px; 
        height: 250px;
    }
    
    .final-pics img { 
        width: 160px; /* Bigger size */
        height: auto;
        border: 4px solid #000; 
        border-radius: 10px; 
        box-shadow: 5px 5px 0 rgba(0,0,0,0.1);
        position: relative;
    }

    .float-1 { animation: floating 3s ease-in-out infinite; }
    .float-2 { animation: floating 4s ease-in-out infinite; animation-delay: 0.5s; }
    .float-3 { animation: floating 3.5s ease-in-out infinite; animation-delay: 1s; }

    @keyframes floating {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-15px); }
        100% { transform: translateY(0px); }
    }

    .shake { animation: shake 0.4s; }
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-8px); }
        75% { transform: translateX(8px); }
    }
</style>
</head>
<body>

    <div class="anime-bg-layer" id="bgLayer"></div>
    <audio id="bgMusic"><source src="assets/song.mp3" type="audio/mpeg"></audio>
    <button id="musicToggle" onclick="toggleMusic()">üîä Pause Music</button>

    <div id="confirmOverlay">
        <div class="modal-box">
            <h2 style="color:#d63031;">‚ö†Ô∏è SECURITY WARNING</h2>
            <p>Accessing 'No' choice may leak sensitive pasta footage.</p>
            <button class="btn" onclick="confirmNo(true)" style="background:#ff7675; color:white;">Proceed</button>
            <button class="btn" onclick="confirmNo(false)">Cancel</button>
        </div>
    </div>

    <div id="wrongPopupOverlay">
        <div class="modal-box">
            <h2 style="color:#d63031;">‚ùå WRONG ANSWER</h2>
            <p id="wrongPopupText" style="font-size: 1.2em;"></p>
            <button class="btn" onclick="closeWrongPopup()">Try Again ‚Üª</button>
        </div>
    </div>

    <div id="videoOverlay">
        <h2 id="videoRoastText" style="color:white; margin-bottom:20px;"></h2>
        <video id="pastaVideo" playsinline><source src="assets/pasta.mp4" type="video/mp4"></video>
    </div>

    <div class="sketch-container" id="mainBox">
        <div id="disclaimer" style="display:none; color:#856404; background:#fff3cd; padding:10px; margin-bottom:10px; border:1px solid #856404; font-size:0.9em;">‚ö†Ô∏è Disclaimer: The real answer is "Golf with your Friends" but it was too easy lol.</div>

        <div id="step0" class="step active-step">
            <h1 style="font-size: 2.2em;">Chloe, Will you be my Valentine? (‚óï‚Äø‚óï)</h1>
            <div style="height: 100px; display: flex; justify-content: center; align-items: center; gap: 30px;">
                <button class="btn" id="yesBtn">YES!</button>
                <button class="btn" id="noBtn" onclick="initiateNoProcess()">No</button>
            </div>
        </div>

        <div id="step1" class="step">
            <h2 style="color: #ff4757;">‚ú® I KNEW IT! üòâ ‚ú®</h2>
            <p>Ready for the quiz? We gotta check you first tho ‚ù§Ô∏è</p>
            <button class="btn" onclick="goToStep(2)">Start Quiz! ‚úèÔ∏è</button>
            <div class="nav-container"><button class="btn" style="font-size:0.8em;" onclick="goToStep(0)">‚Üê Back</button></div>
        </div>

        <div id="step2" class="step">
            <img id="proofImage" src="">
            <h3 id="questionText">Question Text</h3>
            <div id="choices" style="display: flex; flex-direction: column;"></div>
            <p id="msgDisplay" style="color: #636e72; font-style: italic; min-height: 2em;"></p>
            <div class="nav-container">
                <button class="btn" style="font-size:0.8em;" id="backBtn" onclick="prevQuizQuestion()">‚Üê Back</button>
                <button class="btn" id="homeBtn" style="font-size:0.7em; background:#eee; display:none;" onclick="goToStep(0)">üè† Home</button>
                <button class="btn" id="nextBtn" style="font-size:0.8em; visibility:hidden;" onclick="nextQuizQuestion()">Next ‚Üí</button>
            </div>
        </div>

        <div id="step3" class="step">
            <h2 style="color: #ff4757;">Thank you for being the best Valentine ever now and forever ‚ù§Ô∏è</h2>
            <div class="final-pics">
                <img src="assets/us1.jpeg" class="float-1">
                <img src="assets/us2.jpeg" class="float-2">
                <img src="assets/us3.jpeg" class="float-3">
            </div>
            <div class="nav-container">
                <button class="btn" style="font-size:0.8em;" onclick="goToStep(2)">‚Üê Back to Quiz</button>
            </div>
        </div>
    </div>

<script>
    // --- AUDIO ---
    const playlist = ["assets/song.mp3", "assets/song2.mp3"];
    let currentTrackIndex = 0;
    const bgMusic = document.getElementById('bgMusic');
    bgMusic.onended = () => {
        currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
        bgMusic.src = playlist[currentTrackIndex];
        bgMusic.play();
    };

    function toggleMusic() {
        if (bgMusic.paused) { bgMusic.play(); musicToggle.innerText = "üîä Pause Music"; }
        else { bgMusic.pause(); musicToggle.innerText = "üîá Play Music"; }
    }

    // --- PASTA BLACKMAIL ---
    const noBtn = document.getElementById('noBtn');
    const pastaVideo = document.getElementById('pastaVideo');
    const videoOverlay = document.getElementById('videoOverlay');
    const musicToggle = document.getElementById('musicToggle');
    const proofImg = document.getElementById('proofImage');

    let noClickCount = 0;
    function initiateNoProcess() {
        if (noClickCount === 0) document.getElementById('confirmOverlay').style.display = 'flex';
        else processVideoLeak();
    }
    function confirmNo(confirmed) {
        document.getElementById('confirmOverlay').style.display = 'none';
        if (confirmed) processVideoLeak();
    }
    function processVideoLeak() {
        noClickCount++;
        let playTime = noClickCount === 1 ? 5000 : 10000;
        document.getElementById('videoRoastText').innerText = noClickCount === 1 ? "Unauthorized Access! 5s leak..." : "Critical Error! 10s leak incoming...";
        videoOverlay.style.display = 'flex';
        pastaVideo.currentTime = 0; pastaVideo.play();
        setTimeout(() => {
            pastaVideo.pause(); videoOverlay.style.display = 'none';
            if (noClickCount === 2) {
                noBtn.innerText = "Yes Absolutely ‚ù§Ô∏è";
                noBtn.onclick = () => { bgMusic.play(); goToStep(1); };
            }
        }, playTime);
    }

    // --- WRONG ANSWER POPUP ---
    function showWrongPopup(msg) {
        document.getElementById('wrongPopupText').innerText = msg;
        document.getElementById('wrongPopupOverlay').style.display = 'flex';
    }
    function closeWrongPopup() { document.getElementById('wrongPopupOverlay').style.display = 'none'; }

    // --- NAVIGATION ---
    function goToStep(stepNum) {
        document.querySelectorAll('.step').forEach(s => s.classList.remove('active-step'));
        document.getElementById('step' + stepNum).classList.add('active-step');
        if(stepNum === 0) { 
            bgMusic.pause(); bgMusic.currentTime = 0; 
            currentTrackIndex = 0; bgMusic.src = playlist[0];
            musicToggle.style.display = 'none';
            noClickCount = 0; noBtn.innerText = "No";
            noBtn.onclick = initiateNoProcess;
        } else musicToggle.style.display = 'block';
        if(stepNum === 2) loadQuestion();
    }

    document.getElementById('yesBtn').onclick = () => { bgMusic.play(); goToStep(1); };

    // --- QUIZ DATA ---
    const quizData = [
        {
            q: "What is the Steam game we've played the most together?",
            options: [
                { text: "Age of Empires", msg: "Correct! üè∞", img: "assets/aoe.jpg" },
                { text: "Stardew Valley", msg: "Close, i thought this was it after golf.", img: "assets/stardew.jpg" },
                { text: "Overcooked", msg: "I thought it had more hours too.", img: "assets/overcooked.jpg" },
                { text: "Sea of Thieves", msg: "We didn't play this much tbh.", img: "assets/sea.jpg" }
            ],
            correctIndex: 0, showDisclaimer: true, bg: "assets/bg1.jpg", answered: false
        },
        {
            q: "Where did we go for our first date in Sri Lanka?",
            options: [
                { text: "Port City", msg: "Nope! That wasn't it." },
                { text: "One Galle Face", msg: "Not quite, keep thinking." },
                { text: "Fire Beach", msg: "Correct! üèñÔ∏è", img: "assets/firebeach.jpeg" },
                { text: "Lotus Tower", msg: "Wrong! We went there later." }
            ],
            correctIndex: 2, bg: "assets/bg2.jpg", answered: false
        },
        {
            q: "The first time ever we ate in, what type of food was it?",
            options: [
                { text: "Italian", msg: "Nope, too fancy for a first meal." },
                { text: "Japanese", msg: "Correct! üç£", img: "assets/japanese.jpg" },
                { text: "Chinese", msg: "Close but no." },
                { text: "American", msg: "Wrong." }
            ],
            correctIndex: 1, bg: "assets/bg3.jpg", answered: false
        },
        {
            q: "What was the exact story reply I sent to you on IG after we met?",
            options: [
                { text: "Hows the hangover chloe? ", msg: "Correct! No apostrophe. üòÇ", img: "assets/ig_reply.jpeg" },
                { text: "How's the hangover chloe?", msg: "So close! I don't use apostrophes." },
                { text: "Hows the hangover chloe", msg: "Check punctuation!" },
                { text: "How's the hangover chloe?üòÇ", msg: "Too much energy." }
            ],
            correctIndex: 0, bg: "assets/bg4.jpg", answered: false
        },
        {
            q: "What was the first thing i posted about us?",
            options: [
                { text: "Holey Moley Adelaide", msg: "Nope." },
                { text: "Korean BBQ Adelaide", msg: "I wish." },
                { text: "Art Museum Adelaide", msg: "Correct! üé®", img: "assets/art_museum.jpeg" },
                { text: "Arcade in Holey Moley", msg: "Almost." }
            ],
            correctIndex: 2, bg: "assets/bg5.jpg", answered: false
        },
        {
            q: "What is the first ever gift I got you?",
            options: [
                { text: "Flowers", msg: "Classic, but not the very first." },
                { text: "Chocolate", msg: "Correct! üç´", img: "assets/choc_gift.jpg" },
                { text: "Necklace", msg: "Not the first one." },
                { text: "Bracelet", msg: "Later on." }
            ],
            correctIndex: 1, bg: "assets/bg6.jpg", answered: false
        },
        {
            q: "What was the third song we added to OUR Spotify playlist?",
            options: [
                { text: "Red Leather", msg: "Nope." },
                { text: "I wanna be yours", msg: "Great song, but not #3." },
                { text: "Lost in the Fire", msg: "Almost!" },
                { text: "Tonight (Best You Ever Had)", msg: "Correct! üéµ", img: "assets/spotify.jpeg" }
            ],
            correctIndex: 3, bg: "assets/bg7.jpg", answered: false
        }
    ];

    let currentQ = 0;
    function loadQuestion() {
        const data = quizData[currentQ];
        document.getElementById('questionText').innerText = data.q;
        const choicesDiv = document.getElementById('choices');
        choicesDiv.innerHTML = "";
        document.getElementById('msgDisplay').innerText = "";
        document.getElementById('bgLayer').style.backgroundImage = `url('${data.bg}')`;
        document.getElementById('disclaimer').style.display = data.showDisclaimer ? "block" : "none";
        document.getElementById('homeBtn').style.display = currentQ >= 1 ? "block" : "none";
        
        proofImg.style.display = "none";
        const nBtn = document.getElementById('nextBtn');
        nBtn.style.visibility = data.answered ? "visible" : "hidden";

        data.options.forEach((opt, idx) => {
            const b = document.createElement('button');
            b.classList.add('btn'); b.innerText = opt.text;
            if(data.answered && idx === data.correctIndex) b.style.background = "#c2fbd7";
            b.onclick = () => {
                const isCorrect = (idx === data.correctIndex);
                const isQ1 = (currentQ === 0);
                if (isCorrect || isQ1) {
                    proofImg.src = opt.img; proofImg.style.display = "block";
                    document.getElementById('msgDisplay').innerText = opt.msg;
                } else {
                    proofImg.style.display = "none";
                    showWrongPopup(opt.msg);
                }
                if(isCorrect) {
                    b.style.background = "#c2fbd7"; data.answered = true; nBtn.style.visibility = "visible";
                } else {
                    document.getElementById('mainBox').classList.add('shake');
                    setTimeout(() => document.getElementById('mainBox').classList.remove('shake'), 400);
                    b.style.background = "#ff9999";
                }
            };
            choicesDiv.appendChild(b);
        });
    }

    function nextQuizQuestion() { currentQ++; if(currentQ < quizData.length) loadQuestion(); else goToStep(3); }
    function prevQuizQuestion() { if(currentQ > 0) { currentQ--; loadQuestion(); } else goToStep(1); }
</script>
</body>
</html>